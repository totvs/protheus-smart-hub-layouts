{
	"L1_FILIAL": "&self:oRegistro['filial']",
	"L1_CLIENTE": "&IIF( Empty(self:oRegistro['customerCodeErp']), SuperGetMv('MV_CLIPAD', .F., '000001'), Substr(self:oRegistro['customerCodeErp'],1,TamSx3('L1_CLIENTE')[1]) )",
	"L1_LOJA": "&IIF( Empty(self:oRegistro['customerCodeErp']), SuperGetMv('MV_LOJAPAD', .F., '01'), Substr(self:oRegistro['customerCodeErp'],TamSx3('L1_CLIENTE')[1]+1,TamSx3('L1_LOJA')[1]))",
	"L1_OPERADO": "C01",
	"L1_EMISSAO": "&self:oRegistro['taxDocumentIssueDate']",
	"L1_HORA": "&Substr(self:oRegistro['taxDocumentIssueDate'],12,TamSx3('L1_HORA')[1])",
	"L1_EMISNF": "&self:oRegistro['taxDocumentIssueDate']",
	"L1_DTLIM": "&self:oRegistro['taxDocumentIssueDate']",
	"L1_NUMMOV": "01",
	"L1_NUMCFIS": "&self:oXmlSefaz:get( , {'ide', 'nNF'}, self:oRegistro['Ccf'])",
	"L1_DOC": "&self:oXmlSefaz:get( , {'ide', 'nNF'}, self:oRegistro['Ccf'])",
	"L1_SERIE": "&PadR(self:oRegistro['taxDocumentSeries'],TamSx3('L1_SERIE')[1])",
	"L1_SERPDV": "&self:oRegistro['stationCode']",
	"L1_KEYNFCE": "&Right(self:oRegistro['taxDocumentKey'],44)",
	"L1_COMIS": 0,
	"L1_VLRTOT": "&self:oXmlSefaz:getTotal({'ICMSTot', 'vProd'},0) - self:oXmlSefaz:getTotal({'ICMSTot', 'vDesc'}, 0) - self:oXmlSefaz:getTotal({'DescAcrEntr', 'vDescSubtot'}, 0)",
	"L1_VALBRUT": "&(self:oXmlSefaz:getTotal({'ICMSTot', 'vProd'},0) +self:oXmlSefaz:getTotal({'ICMSTot', 'vOutro'}, 0) + self:oXmlSefaz:getTotal({'DescAcrEntr', 'vAcresSubtot'}, 0)) - self:oXmlSefaz:getTotal({'ICMSTot', 'vDesc'}, 0) - self:oXmlSefaz:getTotal({'DescAcrEntr', 'vDescSubtot'}, 0)",
	"L1_VLRLIQ": "&(self:oXmlSefaz:getTotal({'ICMSTot', 'vProd'},0) +self:oXmlSefaz:getTotal({'ICMSTot', 'vOutro'}, 0) + self:oXmlSefaz:getTotal({'DescAcrEntr', 'vAcresSubtot'}, 0)) - self:oXmlSefaz:getTotal({'ICMSTot', 'vDesc'}, 0) - self:oXmlSefaz:getTotal({'DescAcrEntr', 'vDescSubtot'}, 0)",
	"L1_VALMERC": "&self:oXmlSefaz:getTotal({'ICMSTot', 'vProd'},0)",
	"L1_DESCONT": 0,
	"L1_DESPESA": "&self:oXmlSefaz:getTotal({'ICMSTot', 'vOutro'}, 0)",
	"L1_FRETE": "&self:oXmlSefaz:getTotal({'ICMSTot', 'vFrete'}, 0)",
	"L1_SEGURO": "&self:oXmlSefaz:getTotal({'ICMSTot', 'vSeg'}, 0)",
	"L1_ORIGEM": "N",
	"L1_CGCCLI": "&IIF( Empty(self:oRegistro['customerFederalId']), '', strTran( strTran( strTran( self:oRegistro['customerFederalId'], '-', ''), '/', ''), '.', '') )",
	"L1_CONDPG": "CN",
	"L1_SITUA": "IP",
	"L1_TIPO": "V",
	"L1_TIPOCLI": "&Posicione('SA1',1,xFilial('SA1')+self:oRegistro['customerCodeErp'],'A1_TIPO')",
	"L1_ESPECIE": "&IIf(Upper(self:oRegistro['taxDocumentType']) == 'NFE','SPED',Upper(self:oRegistro['taxDocumentType']))",
	"L1_PDV": "001",
	"L1_ESTACAO": "&self:oRegistro['stationCode']",
	"L1_INDPRES": "&self:oXmlSefaz:get( , {'ide', 'indPres'}, '')",
	"L1_TROCO1": "&self:oXmlSefaz:get( , {'pag', 'vTroco'}, 0)",
	"L1_PRONFCE": "",
	"L1_RETSFZ": "",
	"SL2": [
		{
			"L2_FILIAL": "&self:oRegistro['filial']",
			"L2_PRODUTO": "&self:oXmlSefaz:getDet({'prod', 'cProd'},nItem,'')",
			"L2_POSIPI": "&self:oXmlSefaz:getDet({'prod', 'NCM'},nItem,'')",
			"L2_ITEM": "&StrZero(nItem, TamSx3('L2_ITEM')[1])",
			"L2_DESCRI": "&Substr(self:oXmlSefaz:getDet({'prod', 'xProd'}, nItem),1,TamSx3('L2_DESCRI')[1])",
			"L2_QUANT": "&self:oXmlSefaz:getDet({'prod', 'qCom'}, nItem,'')",
			"L2_VRUNIT": "&A410ARRED(self:oXmlSefaz:getDet({'prod', 'vUnCom'},nItem,0) - ( ( self:oXmlSefaz:getDet({'prod', 'vDesc'}, nItem, 0) + self:oXmlSefaz:getDet({'prod', 'vRatDesc'},nItem, 0) ) / self:oXmlSefaz:getDet({'prod', 'qCom'},nItem,0) ))",
			"L2_PRCTAB": "&self:oXmlSefaz:getDet({'prod', 'vUnCom'},nItem,0)",
			"L2_VLRITEM": "&self:oXmlSefaz:getDet({'prod', 'vProd'}, nItem,0) - ( self:oXmlSefaz:getDet({'prod', 'vDesc'},nItem, 0) + self:oXmlSefaz:getDet({'prod', 'vRatDesc'}, nItem, 0) )",
			"L2_LOCAL": "&SuperGetMv('MV_LOCPAD', .F., '01')",
			"L2_LOTECTL": "",
			"L2_UM": "&self:oXmlSefaz:getDet({'prod', 'uCom'}, nItem,'')",
			"L2_VALDESC": "&self:oXmlSefaz:getDet({'prod', 'vDesc'}, nItem, 0)",
			"L2_DESCPRO": "&self:oXmlSefaz:getDet({'prod', 'vRatDesc'}, nItem, 0)",
			"L2_DESC": "&NoRound((self:oXmlSefaz:getDet({'prod', 'vDesc'}, nItem, 0) * 100)/self:oXmlSefaz:getDet({'prod', 'vProd'}, nItem,0),TamSX3('D2_DESC')[2])",
			"L2_DESPESA": "&self:oXmlSefaz:getDet({'prod', 'vOutro'}, nItem, 0) + self:oXmlSefaz:getDet({'prod', 'vRatAcr'}, nItem, 0)",
			"L2_TES": "&RmiTesProd(self:oXmlSefaz:getDet({'prod', 'cProd'}, nItem,0))",
			"L2_DOC": "&self:oXmlSefaz:get( , {'ide', 'nNF'}, self:oRegistro['Ccf'])",
			"L2_SERIE": "&PadR(self:oRegistro['taxDocumentSeries'],TamSx3('L1_SERIE')[1])",
			"L2_ESPECIE": "&IIf(Upper(self:oRegistro['taxDocumentType']) == 'NFE','SPED',Upper(self:oRegistro['taxDocumentType']))",
			"L2_EMISSAO": "&self:oRegistro['taxDocumentIssueDate']",
			"L2_VEND": "&self:oRegistro['userErpCode']",
			"L2_CF": "&self:oXmlSefaz:getDet({'prod', 'CFOP'}, nItem,0)",
			"L2_PICM": "&self:oXmlSefaz:getDetIcms('pICMS', nItem, 0)",
			"L2_VALICM": "&self:oXmlSefaz:getDetIcms('vICMS', nItem, 0)",
			"L2_BASEICM": "&self:oXmlSefaz:getDetIcms('vBC', nItem, 0)",
			"L2_MODBC": "&self:oXmlSefaz:getDetIcms('modBC', nItem, '0')",
			"L2_ORIGEM": "&self:oXmlSefaz:getDetIcms('Orig', nItem, '0')",
			"L2_CLASFIS": "&self:oXmlSefaz:getDetIcms('Orig', nItem, ' ') + self:oXmlSefaz:getDetIcms('CST', nItem, '  ')",
			"L2_VALPS2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('vPIS', nItem, 0),0)",
			"L2_BASEPS2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('vBC', nItem, 0),0)",
			"L2_ALIQPS2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('pPIS', nItem, 0) ,0)",
			"L2_CSTPIS": "&self:oXmlSefaz:getDetPIS('CST', nItem, '')",
			"L2_VALPIS": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('vPIS', nItem, 0),0)",
			"L2_BASEPIS": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('vBC', nItem, 0),0)",
			"L2_ALIQPIS": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetPIS('pPIS', nItem, 0),0)",
			"L2_VALCF2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('vCOFINS', nItem, 0),0)",
			"L2_BASECF2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('vBC', nItem, 0),0)",
			"L2_ALIQCF2": "&IIF( RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('pCOFINS', nItem, 0) ,0)",
			"L2_CSTCOF": "&self:oXmlSefaz:getDetCOF('CST', nItem, '')",
			"L2_VALCOFI": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('vCOFINS', nItem, 0),0)",
			"L2_BASECOF": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('vBC', nItem, 0),0)",
			"L2_ALIQCOF": "&IIF( !RMIRetApur(self:oRegistro['IdentificacaoFidelidade']),self:oXmlSefaz:getDetCOF('pCOFINS', nItem, 0),0)",
			"L2_BRICMS": "&self:oXmlSefaz:getDetIcms('vBCSTRet', nItem, 0)",
			"L2_ICMSRET": "&self:oXmlSefaz:getDetIcms('vICMSSTRet', nItem, 0)",
			"L2_BASFECP": "&IIF( self:oXmlSefaz:getDetIcms('vFCP', nItem, 0) > 0, self:oXmlSefaz:getDetIcms('vBC', nItem, 0), 0)",
			"L2_ALQFECP": "&self:oXmlSefaz:getDetIcms('pFCP', nItem, 0)",
			"L2_VALFECP": "&self:oXmlSefaz:getDetIcms('vFCP', nItem, 0)",
			"L2_ALQFCST": "&self:oXmlSefaz:getDetIcms('pFCPSTRet', nItem, 0)",
			"L2_VFECPST": "&self:oXmlSefaz:getDetIcms('vFCPSTRet', nItem, 0)",
			"L2_PREDIC": "&IiF(self:oXmlSefaz:getDetIcms('pRedBC', nItem, 0) > 0,100-(self:oXmlSefaz:getDetIcms('pRedBC', nItem,0)),0)"
		}
	],
	"SL4": [
		{
			"L4_FILIAL": "&self:oRegistro['filial']",
			"L4_FORMA": "&self:oRegistro['paymentMethods'][nItem]['paymentMethod']['paymentMethodAcronymERP']",
			"L4_DATA": "&IIf(!Empty(self:oRegistro['paymentMethods'][nItem]['dueDate']),self:oRegistro['paymentMethods'][nItem]['dueDate'],self:oRegistro['taxDocumentIssueDate'])",
			"L4_VALOR": "&self:oRegistro['paymentMethods'][nItem]['paymentValue']",
			"L4_ADMINIS": "&IIF(!Empty(self:oRegistro['paymentMethods'][nItem]['financialRule']),self:oRegistro['paymentMethods'][nItem]['financialRule'],self:Administradora(self:oRegistro['paymentMethods'][nItem]['paymentMethod']['paymentMethodAcronymERP'],self:oRegistro['paymentMethods'][nItem]['TEFcardFlag'],self:oRegistro['paymentMethods'][nItem]['acquirer']))",
			"L4_TERCEIR": false,
			"L4_AUTORIZ": "&self:oRegistro['paymentMethods'][nItem]['TEFAuthCode']",
			"L4_NSUTEF": "&self:oRegistro['paymentMethods'][nItem]['TEFNSU']",
			"L4_BANDEIR": "&self:oRegistro['paymentMethods'][nItem]['TEFcardFlag']",
			"L4_PARCTEF": "",
			"L4_REDEAUT": "&self:oRegistro['paymentMethods'][nItem]['acquirer']",
			"L4_DATATEF": "",
			"L4_HORATEF": "",
			"L4_DOCTEF": "&self:oRegistro['paymentMethods'][nItem]['TEFDocument']"
		}
	],
	"configPSH": {
		"Version": "1.0"
	}
}
